"use strict";(app=angular.module("app",["ngRoute"])).config(["$routeProvider","$locationProvider",function(e,o){o.hashPrefix(""),e.when("/",{templateUrl:"app/html/home.html",controller:"homeController",controllerAs:"home"}).otherwise({redirectTo:"/"})}]),(app=angular.module("app")).directive("header",[function(){return{templateUrl:"app/html/header.html",restrict:"ACE"}}]),(app=angular.module("app")).controller("footerController",["$scope",function(e){e.now=moment().format("Y")}]),app.directive("footer",[function(){return{templateUrl:"app/html/footer.html",controller:"footerController",restrict:"ACE"}}]),(app=angular.module("app")).directive("datepicker",["$timeout",function(i){return{restrict:"ACE",require:"ngModel",templateUrl:"app/html/datepicker.html",link:function(o,e,t,n){e.datetimepicker({defaultDate:"moment",minDate:"moment",format:"L",locale:"fr"}),n.$setViewValue(e.data("DateTimePicker").date()),e.on("dp.change",function(e){i(function(){o.$apply(function(){n.$setViewValue(e.date)})})}),n.$render=function(){e.data("DateTimePicker").date(n.$viewValue)}}}}]),(app=angular.module("app")).controller("homeController",["$scope","$http",function(a,e){a.init=function(){var e;for(a.master={},a.booking={},a.roomCheck=!1,a.success=!1,a.fail=!1,a.booking.internal=[],e=0;e<12;e++)a.booking.internal.push({id:e,isChecked:!1});a.sample={name:"",number:"",contact:""},a.booking.external=[],a.booking.external.push(angular.copy(a.sample)),a.booking.assistance=!1,a.booking.audio=!1,a.hoursCheck=!0},a.update=function(){a.form.$valid&&a.checkRooms()&&a.hoursCheck?(a.success=!0,a.fail=!1,a.master=angular.copy(a.booking),a.master.date=a.booking.date.format("LL"),a.master.starttime=a.booking.starttime.format("LT"),a.master.endtime=a.booking.endtime.format("LT"),console.log("success",a.master)):(a.success=!1,a.fail=!0)},a.addExternalRoom=function(){a.booking.external.push(angular.copy(a.sample))},a.removeExternalRoom=function(e){-1<e&&a.booking.external.splice(e,1)},a.checkRooms=function(){a.booking.representError=!1,a.booking.addressError=!1;var o=0;if(_.forEach(a.booking.internal,function(e){!0===e.isChecked&&o++}),1<o)return!(a.roomCheck=!1);for(var e=0,t=a.booking.external.length-1;0<=t;t--){var n=a.booking.external[t].name,i=a.booking.external[t].number,r=a.booking.external[t].contact;_.isEmpty(n)||_.isEmpty(i)||_.isEmpty(r)||e++}return 1===o&&1<=e||0===o&&2<=e?_.isUndefined(a.booking.represent)||_.isEmpty(a.booking.represent)?(a.booking.representError=!0,!(a.roomCheck=!0)):_.isUndefined(a.booking.address)||_.isEmpty(a.booking.address)?(a.booking.addressError=!0,!(a.roomCheck=!0)):!(a.roomCheck=!1):!(a.roomCheck=!0)},a.$watch("booking.starttime",function(){_.isUndefined(a.booking.starttime)||(!1===a.booking.starttime&&(a.booking.starttime=moment().hours("10").minutes("00"),a.booking.endtime=moment().hours("11").minutes("00")),a.booking.starttime.hours()>a.booking.endtime.hours()?a.hoursCheck=!1:a.booking.starttime.hours()===a.booking.endtime.hours()&&a.booking.starttime.minutes()>=a.booking.endtime.minutes()?a.hoursCheck=!1:a.hoursCheck=!0)}),a.$watch("booking.endtime",function(){_.isUndefined(a.booking.endtime)||(!1===a.booking.endtime&&(a.booking.starttime=moment().hours("10").minutes("00"),a.booking.endtime=moment().hours("11").minutes("00")),a.booking.starttime.hours()>a.booking.endtime.hours()?a.hoursCheck=!1:a.booking.starttime.hours()===a.booking.endtime.hours()&&a.booking.starttime.minutes()>=a.booking.endtime.minutes()?a.hoursCheck=!1:a.hoursCheck=!0)}),a.init()}]),(app=angular.module("app")).directive("timepicker",["$timeout",function(i){return{restrict:"ACE",require:"ngModel",templateUrl:"app/html/timepicker.html",link:function(o,e,t,n){void 0===t.hours&&(t.hours="10"),void 0===t.minutes&&(t.minutes="00"),e.children("input").attr("id",t.idfocus),e.datetimepicker({defaultDate:moment().hours(o.$eval(t.hours)).minutes(o.$eval(t.minutes)),enabledHours:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],stepping:15,format:"LT",locale:"fr"}),n.$setViewValue(e.data("DateTimePicker").date()),e.on("dp.change",function(e){i(function(){o.$apply(function(){n.$setViewValue(e.date)})})}),n.$render=function(){e.data("DateTimePicker").date(n.$viewValue)}}}}]);var app=angular.module("app"),integerRegex=/^\-?\d+$/;app.directive("integer",function(){return{require:"ngModel",link:function(e,o,t,n){n.$validators.integer=function(e,o){return!!n.$isEmpty(e)||!!integerRegex.test(o)}}}});